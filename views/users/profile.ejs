<% layout("/layouts/boilerplate") %>

<style>
/* ======================
   PROFILE PAGE REFINED
====================== */

.profile-page {
  max-width: 1100px;
  margin: 2.5rem auto 4rem auto;
}

/* ----------------------
   TOP SECTION
----------------------- */

.profile-top {
  display: grid;
  grid-template-columns: 350px 1fr;
  gap: 2.5rem;
  margin-bottom: 3.5rem;
}

/* PROFILE INFO */

.profile-info {
  background: #ffffff;
  padding: 2rem 1.5rem;
  border-radius: 14px;
  text-align: center;
  box-shadow: 0 4px 18px rgba(0,0,0,0.06);
}

.profile-avatar {
  width: 100px;
  height: 100px;
  margin: 0 auto 1rem auto;
  border-radius: 50%;
  background: #fe424d;
  color: white;
  font-size: 38px;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}

.profile-info h2 {
  font-weight: 600;
  margin-bottom: 0.4rem;
}

.profile-info p {
  color: #666;
  font-size: 0.95rem;
}

/* EDIT FORM */

.profile-edit {
  background: #ffffff;
  padding: 2rem;
  border-radius: 14px;
  box-shadow: 0 4px 18px rgba(0,0,0,0.06);
}

.profile-edit h3 {
  font-weight: 600;
  margin-bottom: 1.8rem;
}

.form-group {
  margin-bottom: 1.4rem;
}

.form-group label {
  font-size: 0.9rem;
  margin-bottom: 0.4rem;
  display: block;
}

.form-group input {
  width: 100%;
  padding: 10px 12px;
  border-radius: 8px;
  border: 1px solid #ddd;
  font-size: 0.95rem;
}

.form-group input:focus {
  outline: none;
  border-color: #fe424d;
  box-shadow: 0 0 0 2px rgba(254,66,77,0.15);
}

.save-btn {
  padding: 10px 18px;
  background: #fe424d;
  border: none;
  color: white;
  border-radius: 8px;
  font-size: 0.95rem;
}

.save-btn:hover {
  opacity: 0.9;
}

/* ----------------------
   LISTINGS
----------------------- */

.profile-listings h3 {
  font-weight: 600;
  margin-bottom: 2rem;
}

.listing-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
  gap: 28px;
}

.listing-card {
  background: #fff;
  border-radius: 14px;
  overflow: hidden;
  text-decoration: none;
  color: inherit;
  box-shadow: 0 6px 22px rgba(0,0,0,0.07);
  transition: 0.25s ease;
}

.listing-card:hover {
  transform: translateY(-6px);
  box-shadow: 0 12px 28px rgba(0,0,0,0.12);
}

.listing-card img {
  width: 100%;
  height: 240px;
  object-fit: cover;
}

.listing-info {
  padding: 1.2rem;
}

.listing-info h4 {
  font-size: 1.1rem;
  margin-bottom: 0.4rem;
}

.listing-info p {
  font-size: 0.9rem;
  color: #444;
}

/* ----------------------
   RESPONSIVE
----------------------- */

@media (max-width: 992px) {
  .profile-top {
    grid-template-columns: 1fr;
  }
}

.profile-avatar {
  width: 100px;
  height: 100px;
  margin: 0 auto 1rem auto;
  border-radius: 50%;
  background: #fe424d;
  color: white;
  font-size: 38px;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}

.profile-avatar img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 50%;
}


</style>



<div class="profile-page">

    <!-- TOP SECTION -->
    <div class="profile-top">
  
      <!-- PROFILE INFO -->
      <div class="profile-info">
        <div class="profile-avatar">
          <% if (currUser.profileImage) { %>
            <img src="<%= currUser.profileImage %>" alt="profile">
          <% } else { %>
            <span><%= currUser.username.charAt(0).toUpperCase()%></span>
          <% } %>
        </div>
  
        <h2><%= currUser.username %></h2>
        <p><%= currUser.email %></p>
      </div>
  
      <!-- EDIT FORM -->
      <div class="profile-edit">
        <h3>Edit Profile</h3>
  
        <form action="/profile" method="POST" enctype="multipart/form-data">
          <div class="form-group">
            <label>Username</label>
            <input type="text" name="username" value="<%= currUser.username %>">
          </div>
  
          <div class="form-group">
            <label>Email</label>
            <input type="email" name="email" value="<%= currUser.email %>">
          </div>
  
          <div class="form-group">
            <label>Profile Photo</label>
            <input type="file" name="profileImage">
          </div>
  
          <button type="submit" class="save-btn">Save Changes</button>
        </form>
      </div>
  
    </div>
  
    <!-- LISTINGS SECTION -->
    <div class="profile-listings">
      <h3>Your Hosted Listings</h3>
  
      <% if (listings.length === 0) { %>
        <p>You haven’t hosted any listings yet.</p>
      <% } else { %>
        <div class="listing-grid">
          <% listings.forEach(listing => { %>
            <a href="/listings/<%= listing._id %>" class="listing-card">
              <img src="<%= listing.image.url %>" alt="">
              <div class="listing-info">
                <h4><%= listing.title %></h4>
                <p>₹ <%= listing.price %> / night</p>
              </div>
            </a>
          <% }) %>
        </div>
      <% } %>
    </div>
  
  </div>
  